{% if not display_only_list %}
<h1>{% trans "books"|capfirst %}</h1>
    <p>
    {% if perms.library.book_new %}
    <a class="pure-button pure-button-success" href="{% url "book_new" %}">{% trans "new book"|capfirst %}</a> 
    <a class="pure-button pure-button-success" href="{% url "book_add_to_my_library" %}">{% trans "add to my library"|capfirst %}</a> 
    {% endif %}
    <span class="right_buttons"><span class="pure-button pure-button-primary"><a href="?sort_by=title&order=asc" class="fa fa-sort-asc"></a> 
        {% trans "title"|capfirst %} 
        <a href="?sort_by=title&order=desc" class="fa fa-sort-desc"></a></span>
    <span class="pure-button pure-button-primary"><a href="?sort_by=author__lastname&order=asc" class="fa fa-sort-asc"></a> 
        {% trans "author"|capfirst %}
        <a href="?sort_by=author__lastname&order=desc" class="fa fa-sort-desc"></a></span>
    <span class="pure-button pure-button-primary"><a href="?sort_by=editor__name&order=asc" class="fa fa-sort-asc"></a> 
        {% trans "editor"|capfirst %}
        <a href="?sort_by=editor__name&order=desc" class="fa fa-sort-desc"></a></span>
    <span class="pure-button pure-button-primary"><a href="?sort_by=publishing_date&order=asc" class="fa fa-sort-asc"></a> 
        {% trans "published"|capfirst %}
        <a href="?sort_by=publishing_date&order=desc" class="fa fa-sort-desc"></a></span>
    </p>
{% endif %}

<div class="book_collection pure-g">
    {% for book in books %}
    <div class="book pure-u-1-6">
        <p class="cover">
            {% if perms.library.book_detail %}<a href="{% url "book_detail" book.id %}">{% endif %}
                {% if book.cover %}<img src="{{ book.cover.url }}" class="cover" />{% else %}<img src="{% static 'img/book_cover.png' %}" class="cover" />{% endif %}
            {% if perms.library.book_detail %}</a>{% endif %}
        </p>
        <p>
            {% if perms.library.book_detail %}<a href="{% url "book_detail" book.id %}">{% endif %}
            {{ book.title }}
            {% if perms.library.book_detail %}</a>{% endif %}
        </p>
        <p> 
            {% if book.author and perms.library.author_detail %}<a class="black_link" href="{% url "author_detail" book.author.id %}">{% endif %}
            {{ book.author|default:_("unknown")|capfirst }}
            {% if book.author and perms.library.author_detail %}</a>{% endif %}
        </p>
        <p>
             {{ book.editor|default:_("unknown")|capfirst }}
             ({{ book.publishing_date|naturalday:"DATE_FORMAT"|default:_("unknown") }})</p>
        <p>
            {% for owner in book.owners.distinct.all %}
                <a href="{% url "profile_show" owner.id %}">{{ owner|default:_("unknown")|capfirst }}</a>
            {% empty %}
                {% trans "unknown"|capfirst %}
            {% endfor %}
        </p>
        {% if not display_only_list %}
        </div>
        <div class="pure-u-1-12">
            {% if perms.library.book_moderate or perms.library.book_edit or perms.library.book_delete or perms.sharing.lending_new or perms.library.book_remove_from_all_libraries or perms.library.book_remove_from_library or perms.library.ownership_new %}
            <p class="buttons">
                {% comment %}{% if perms.sharing.lending_new %}
                <a class="pure-button pure-button-xsmall" href="{% url "borrowing_this_book_create" book.id %}">{% trans "borrow"|capfirst %}</a>
                {% endif %}{% endcomment %}
                {% if perms.library.book_moderate or perms.library.book_edit and request.user in book.owners.all %}
                <a class="pure-button pure-button-xsmall pure-button-secondary" href="{% url "book_edit" book.id %}">{% trans "edit"|capfirst %}</a><br />
                {% endif %}
                {% if book.owners.all %}
                    {% if perms.library.book_remove_from_all_libraries %}
                        <a class="pure-button pure-button-xsmall pure-button-warning" href="{% url "book_remove_from_library" book.id %}">{% trans "remove"|capfirst %}</a><br />
                    {% elif perms.library.book_remove_from_library and request.user in book.owners.all %}
                        <a class="pure-button pure-button-xsmall pure-button-warning" href="{% url "book_remove_from_library" book.id %}">{% trans "remove"|capfirst %}</a><br />
                    {% endif %}
                {% endif %}
                {% if perms.library.ownership_new and not request.user in book.owners.all %}
                    <a class="pure-button pure-button-xsmall pure-button-success" href="{% url "book_add_this_to_my_library" book.id %}">{% trans "add"|capfirst %}</a><br /> 
                {% endif %}
                {% if perms.library.book_moderate or perms.library.book_delete and request.user in book.owners.all %}
                <a class="pure-button pure-button-xsmall pure-button-error" href="{% url "book_delete" book.id %}">{% trans "delete"|capfirst %}</a><br />
                {% endif %}
            </p>
            {% endif %}
        {% endif %}
    </div>
    {% empty %}
    <p>{% trans "no book in this library !"|capfirst %}</p>
    {% endfor %}
</div>
<div style="clear: both;"></div>
{% if not display_only_list %}
    {% include "common/pagination.html" %}
    {% if perms.library.book_new %}
    <a class="pure-button pure-button-success" href="{% url "book_new" %}">{% trans "new book"|capfirst %}</a> 
    <a class="pure-button pure-button-success" href="{% url "book_add_to_my_library" %}">{% trans "add to my library"|capfirst %}</a> 
    {% endif %}
{% endif %}